# 12.4相机透视矩阵的变化

透视矩阵的变化目前有两种情况

1.窗口大小变化

2.调整相机的视角

其实正好对应相机的透视矩阵的两个关键参数：

**分辨率比例 & 视野FOV**



实现其实比较简单，就是通过OnEvent创建两个事件分发器处理鼠标滚轮事件和窗口缩放事件，然后对应更新上面提到的透视矩阵的两个参数就行。



值得注意的点：

分辨率比例有一个坑，当窗口最小化时，宽/长 = 0/0，这可能让程序崩溃。

所以我们定义一个成员 m_Minimized 初始为false，一旦窗口缩放事件触发就判断长宽是否为 0 ，是则把 m_Minimized 置 true ，如下代码则使用 m_Minimized 控制渲染循环，也就是当 m_Minimized 为 true 时，**暂停所有更新和渲染逻辑**，除了窗口的**事件监听**（在window::OnUpdate中，可能命名不太直观）

```
// 只有在未最小化时，才进行渲染和逻辑更新
if (!m_Minimized)
{
	RendererCommand::ClearColor({ 0.1f, 0.1f, 0.1f, 1.0f });
	RendererCommand::Clear();

	this->OnUpdate();

	s_ProfilingResults.clear();
}

// 无论是否最小化，都处理窗口事件（PollEvents）和交换缓冲区
m_AppWindow->OnUpdate();
```

否则不能执行 glfwPollEvents() ，这时glfw窗口无法获知任何事件，现象就是我们无法再次打开最小化的窗口。